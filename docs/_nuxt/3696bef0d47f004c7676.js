(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{215:function(e,t,r){var content=r(220);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(64).default)("56f83989",content,!0,{sourceMap:!1})},216:function(e,t,r){var content=r(222);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(64).default)("28fb9fa2",content,!0,{sourceMap:!1})},219:function(e,t,r){"use strict";var o=r(215);r.n(o).a},220:function(e,t,r){(t=r(63)(!1)).push([e.i,".img-profile[data-v-69d1b125]{width:150px;height:150px;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0;object-position:50% 0}.people[data-v-69d1b125]{display:-webkit-box;display:flex;border:1px solid #cdcdcd;border-radius:2px;margin-bottom:12px;-webkit-box-align:center;align-items:center}.people div[data-v-69d1b125]{padding:12px}.people div p[data-v-69d1b125]{margin-bottom:0}.people button.text-danger[data-v-69d1b125]:hover{background-color:#ffe9ed}.people button.text-info[data-v-69d1b125]:hover{background-color:#ecfbfb}.divider[data-v-69d1b125]{margin-left:-15px;margin-right:-15px}",""]),e.exports=t},221:function(e,t,r){"use strict";var o=r(216);r.n(o).a},222:function(e,t,r){(t=r(63)(!1)).push([e.i,".no-wrap{overflow:scroll;white-space:nowrap}",""]),e.exports=t},228:function(e,t,r){"use strict";r.r(t);r(24);var o={data:function(){return{add:{name:"",age:"",fileToUpload:null,imagePath:""},progress:0,error:""}},methods:{addPerson:function(){var e=this;this.add.imagePath="hp/".concat(this.add.fileToUpload.name),this.$fireStorage.ref(this.add.imagePath).put(this.add.fileToUpload).on("state_changed",(function(t){var progress=t.bytesTransferred/t.totalBytes*100;e.progress=parseInt(progress)}),(function(t){e.error="There was an error uploading the file: ".concat(t)}),(function(){e.$fireStorage.ref(e.add.imagePath).getDownloadURL().then((function(t){e.progress=0,e.$fireStore.collection("people").add({name:e.add.name,age:parseInt(e.add.age),imagePath:e.add.imagePath,imageURL:t}).then((function(){document.getElementById("fileUpload").value="",e.add.name="",e.add.age=""})).catch((function(t){e.error="Error writing document: ".concat(error)}))})).catch((function(t){e.error="Error getting image path: ".concat(t)}))}))},processFile:function(e){this.add.fileToUpload=e.target.files[0]}}},n=r(32),c=Object(n.a)(o,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("form",{attrs:{id:"add-person"},on:{submit:function(t){return t.preventDefault(),e.addPerson(t)}}},[e.error?r("div",{staticClass:"alert alert-danger"},[e._v(e._s(e.error))]):e._e(),e._v(" "),r("div",{staticClass:"form-group"},[r("label",{attrs:{for:"add-name"}},[e._v("Name")]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.add.name,expression:"add.name"}],staticClass:"form-control",attrs:{type:"text",id:"add-name",required:""},domProps:{value:e.add.name},on:{input:function(t){t.target.composing||e.$set(e.add,"name",t.target.value)}}})]),e._v(" "),r("div",{staticClass:"form-group"},[r("label",{attrs:{for:"add-age"}},[e._v("Age")]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.add.age,expression:"add.age"}],staticClass:"form-control",attrs:{type:"number",id:"add-age",required:""},domProps:{value:e.add.age},on:{input:function(t){t.target.composing||e.$set(e.add,"age",t.target.value)}}})]),e._v(" "),e.progress?r("div",{staticClass:"progress mb-3"},[r("div",{staticClass:"progress-bar",style:"width: "+e.progress+"%",attrs:{role:"progressbar","aria-valuenow":e.progress,"aria-valuemin":"0","aria-valuemax":"100"}},[e._v("\n      "+e._s(e.progress)+"%\n    ")])]):e._e(),e._v(" "),r("div",{staticClass:"form-group"},[r("input",{attrs:{type:"file",name:"fileUpload",id:"fileUpload",accept:"image/*"},on:{change:e.processFile}}),e._v(" "),r("p",{staticClass:"small"},[e._v("Only upload image files.")])]),e._v(" "),r("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[e._v("Add Person")])])}),[],!1,null,null,null).exports,l=(r(6),r(4),r(3),r(1),r(5),r(0));function d(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}var f={name:"HarryPotterCharacter",props:["character"],data:function(){return{selectedUser:"",placeholder:"https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_960_720.png",newImage:null,progress:0}},methods:{deletePerson:function(e){var t=this;this.character.imagePath?this.$fireStorage.ref().child(this.character.imagePath).delete().then((function(){t.$fireStore.collection("people").doc(e).delete()})).catch((function(e){alert("Something didn't delete properly: ".concat(e))})):this.$fireStore.collection("people").doc(e).delete()},openEditModal:function(){this.selectedUser=function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(t){Object(l.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({},this.character),this.$bvModal.show("character-".concat(this.character.id))},editProfileImg:function(e){var t=this,r=e.target.files[0],o="hp/".concat(r.name),n=this.$fireStorage.ref(o).put(r),c=this.character.imagePath;n.on("state_changed",(function(e){var progress=e.bytesTransferred/e.totalBytes*100;t.progress=parseInt(progress)}),(function(e){alert("There was an error uploading the file: ".concat(e))}),(function(){document.getElementById("update-profile-img").value="",t.$fireStorage.ref(o).getDownloadURL().then((function(e){t.progress=0,console.log("URL: ".concat(e)),t.$fireStore.collection("people").doc(t.character.id).update({imagePath:o,imageURL:e}).then((function(){c&&t.$fireStorage.ref().child(c).delete().then((function(){console.log("file ".concat(c," has been deleted"))})).catch((function(e){alert("Error deleting old image: ".concat(e))}))})).catch((function(e){alert("Error: ".concat(e))}))})).catch((function(e){alert("Error getting image path: ".concat(e))}))}))},editPerson:function(e){var t=this;this.$fireStore.collection("people").doc(e).update({name:this.selectedUser.name,age:parseInt(this.selectedUser.age)}).then((function(){console.log("Document successfully updated!"),t.$bvModal.hide("character-".concat(t.character.id))})).catch((function(e){console.error("Error updating document: ",e),t.$bvModal.hide("character-".concat(t.character.id))}))}}},m=(r(219),Object(n.a)(f,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"people",attrs:{"data-id":e.character.id}},[e.character.imageURL?r("img",{staticClass:"img-profile",attrs:{src:e.character.imageURL,alt:"portrait of "+e.character.name}}):r("img",{staticClass:"img-profile",attrs:{src:e.placeholder,alt:"No picture"}}),e._v(" "),r("div",[r("h4",[e._v(e._s(e.character.name))]),e._v(" "),r("p",[e._v(e._s(e.character.age)+" years old")])]),e._v(" "),r("div",{staticClass:"ml-auto"},[r("button",{staticClass:"mx-1 btn btn-link text-info",on:{click:function(t){return e.openEditModal()}}},[e._m(0)]),e._v(" "),r("button",{staticClass:"mx-1 btn btn-link text-danger",on:{click:function(t){return e.deletePerson(e.character.id)}}},[e._m(1)])])]),e._v(" "),r("b-modal",{attrs:{id:"character-"+e.character.id,"hide-footer":""},scopedSlots:e._u([{key:"modal-title",fn:function(){return[e._v("\n      Update Person\n      "),r("span",{staticClass:"small text-muted"},[e._v(e._s(e.selectedUser.id))])]},proxy:!0}])},[e._v(" "),r("div",{staticClass:"d-block"},[r("div",{staticClass:"form-group"},[r("h3",[e._v("Edit Profile Image")]),e._v(" "),r("div",[r("img",{staticClass:"img-profile",attrs:{src:e.character.imageURL?e.character.imageURL:e.placeholder,alt:""}})]),e._v(" "),e.progress?r("div",{staticClass:"progress my-3"},[r("div",{staticClass:"progress-bar",style:"width: "+e.progress+"%",attrs:{role:"progressbar","aria-valuenow":e.progress,"aria-valuemin":"0","aria-valuemax":"100"}},[e._v("\n            "+e._s(e.progress)+"%\n          ")])]):e._e(),e._v(" "),r("p",{staticClass:"mt-2"},[r("input",{attrs:{type:"file",id:"update-profile-img"},on:{change:e.editProfileImg}})])]),e._v(" "),r("div",{staticClass:"divider"},[r("hr")]),e._v(" "),r("form",{attrs:{id:"edit-person"},on:{submit:function(t){return t.preventDefault(),e.editPerson(e.selectedUser.id)}}},[r("h3",[e._v("Edit Info")]),e._v(" "),r("div",{staticClass:"form-group"},[r("label",{attrs:{for:"add-name"}},[e._v("Name")]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedUser.name,expression:"selectedUser.name"}],staticClass:"form-control",attrs:{type:"text",id:"add-name",required:""},domProps:{value:e.selectedUser.name},on:{input:function(t){t.target.composing||e.$set(e.selectedUser,"name",t.target.value)}}})]),e._v(" "),r("div",{staticClass:"form-group"},[r("label",{attrs:{for:"add-age"}},[e._v("Age")]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedUser.age,expression:"selectedUser.age"}],staticClass:"form-control",attrs:{type:"text",id:"add-age",required:""},domProps:{value:e.selectedUser.age},on:{input:function(t){t.target.composing||e.$set(e.selectedUser,"age",t.target.value)}}})]),e._v(" "),r("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[e._v("Update Info")])])])])],1)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("i",{staticClass:"fas fa-pencil-alt"},[t("span",{staticClass:"sr-only"},[this._v("Edit")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("i",{staticClass:"fas fa-trash"},[t("span",{staticClass:"sr-only"},[this._v("Delete")])])}],!1,null,"69d1b125",null).exports),h={data:function(){return{folders:[],files:[]}},mounted:function(){var e=this;this.$fireStorage.ref("hp").listAll().then((function(t){t.prefixes.forEach((function(t){e.folders.push(t),console.log("Folder Ref: ".concat(t))})),t.items.forEach((function(t){e.files.push(t),console.log("Item Ref: ".concat(t))}))})).catch((function(e){alert("Error getting the list: ".concat(e))}))}},v=(r(221),{components:{AddHarryPotterCharacter:c,HarryPotterCharacter:m,ListHarryPotterCharacterImages:Object(n.a)(h,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"alert alert-primary mt-4 no-wrap"},[r("h2",[e._v("List Images")]),e._v(" "),r("ul",{staticClass:"fa-ul"},[e._l(e.folders,(function(t,o){return r("li",{key:o,staticClass:"fa-li"},[r("i",{staticClass:"far fa-folder"}),e._v(" Folder: "+e._s(t))])})),e._v(" "),e._l(e.files,(function(t,o){return r("li",{key:o,staticClass:"fa-li"},[r("i",{staticClass:"far fa-file"}),e._v(" File: "+e._s(t))])}))],2)])}),[],!1,null,null,null).exports},name:"FirebaseFirestore",data:function(){return{message:"Hello Nuxt-Fire",files:[],destroySnapshot:null}},created:function(){var e=this;this.destroySnapshot=this.$fireStore.collection("people").orderBy("age").onSnapshot((function(t){e.files=[],t.docs.forEach((function(t){var r=t.data();r.id=t.id,e.files.push(r)}))}),(function(e){console.log(e.message)}))},beforeDestroy:function(){this.destroySnapshot()}}),_=Object(n.a)(v,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-sm-12"},[r("h1",[e._v(e._s(e.message))]),e._v(" "),r("p",{staticClass:"lead"},[e._v("\n        This is a simple CRUD (Create, Read, Update, Delete) operation made\n        from Nuxt and Firebase\n      ")])]),e._v(" "),r("div",{staticClass:"col-sm-6"},[r("h2",[e._v("Add Character")]),e._v(" "),r("AddHarryPotterCharacter"),e._v(" "),r("ListHarryPotterCharacterImages")],1),e._v(" "),r("div",{staticClass:"col-sm-6"},[r("h2",[e._v("Harry Potter Characters")]),e._v(" "),e._l(e.files,(function(e){return r("div",{key:e.id},[r("HarryPotterCharacter",{attrs:{character:e}})],1)}))],2)])])}),[],!1,null,null,null);t.default=_.exports}}]);